<?php
/**
 * Copyright Â© 2015 Ihor Vansach (ihor@magefan.com). All rights reserved.
 * See LICENSE.txt for license details (http://opensource.org/licenses/osl-3.0.php).
 *
 * Glory to Ukraine! Glory to the heroes!
 */
?>
<?php
/**
 * Stories related posts template
 *
 * @var $block \Magefan\Stories\Block\Post\View\RelatedPosts
 */
?>

<style type="text/css">
    .card{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:#fff;border:1px solid rgba(0,0,0,.125);border-radius:.25rem}.card-block{-webkit-box-flex:1;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:1.25rem}.card-title{margin-bottom:.75rem}.card-subtitle{margin-top:-.375rem;margin-bottom:0}.card-text:last-child{margin-bottom:0}.card-link:hover{text-decoration:none}.card-link+.card-link{margin-left:1.25rem}.card>.list-group:first-child .list-group-item:first-child{border-top-right-radius:.25rem;border-top-left-radius:.25rem}.card>.list-group:last-child .list-group-item:last-child{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.card-header{padding:.75rem 1.25rem;margin-bottom:0;background-color:#f7f7f9;border-bottom:1px solid rgba(0,0,0,.125)}.card-header:first-child{border-radius:calc(.25rem - 1px) calc(.25rem - 1px) 0 0}.card-footer{padding:.75rem 1.25rem;background-color:#f7f7f9;border-top:1px solid rgba(0,0,0,.125)}.card-footer:last-child{border-radius:0 0 calc(.25rem - 1px) calc(.25rem - 1px)}.card-header-tabs{margin-right:-.625rem;margin-bottom:-.75rem;margin-left:-.625rem;border-bottom:0}.card-header-pills{margin-right:-.625rem;margin-left:-.625rem}.card-primary{background-color:#0275d8;border-color:#0275d8}.card-primary .card-footer,.card-primary .card-header{background-color:transparent}.card-success{background-color:#5cb85c;border-color:#5cb85c}.card-success .card-footer,.card-success .card-header{background-color:transparent}.card-info{background-color:#5bc0de;border-color:#5bc0de}.card-info .card-footer,.card-info .card-header{background-color:transparent}.card-warning{background-color:#f0ad4e;border-color:#f0ad4e}.card-warning .card-footer,.card-warning .card-header{background-color:transparent}.card-danger{background-color:#d9534f;border-color:#d9534f}.card-danger .card-footer,.card-danger .card-header{background-color:transparent}.card-outline-primary{background-color:transparent;border-color:#0275d8}.card-outline-secondary{background-color:transparent;border-color:#ccc}.card-outline-info{background-color:transparent;border-color:#5bc0de}.card-outline-success{background-color:transparent;border-color:#5cb85c}.card-outline-warning{background-color:transparent;border-color:#f0ad4e}.card-outline-danger{background-color:transparent;border-color:#d9534f}.card-inverse{color:rgba(255,255,255,.65)}.card-inverse .card-footer,.card-inverse .card-header{background-color:transparent;border-color:rgba(255,255,255,.2)}.card-inverse .card-blockquote,.card-inverse .card-footer,.card-inverse .card-header,.card-inverse .card-title{color:#fff}.card-inverse .card-blockquote .blockquote-footer,.card-inverse .card-link,.card-inverse .card-subtitle,.card-inverse .card-text{color:rgba(255,255,255,.65)}.card-inverse .card-link:focus,.card-inverse .card-link:hover{color:#fff}.card-blockquote{padding:0;margin-bottom:0;border-left:0}.card-img{border-radius:calc(.25rem - 1px)}.card-img-overlay{position:absolute;top:0;right:0;bottom:0;left:0;padding:1.25rem}.card-img-top{border-top-right-radius:calc(.25rem - 1px);border-top-left-radius:calc(.25rem - 1px)}.card-img-bottom{border-bottom-right-radius:calc(.25rem - 1px);border-bottom-left-radius:calc(.25rem - 1px)}@media (min-width:576px){.card-deck{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap}.card-deck .card{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1 0 0%;-ms-flex:1 0 0%;flex:1 0 0%;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.card-deck .card:not(:first-child){margin-left:15px}.card-deck .card:not(:last-child){margin-right:15px}}@media (min-width:576px){.card-group{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap}.card-group .card{-webkit-box-flex:1;-webkit-flex:1 0 0%;-ms-flex:1 0 0%;flex:1 0 0%}.card-group .card+.card{margin-left:0;border-left:0}.card-group .card:first-child{border-bottom-right-radius:0;border-top-right-radius:0}.card-group .card:first-child .card-img-top{border-top-right-radius:0}.card-group .card:first-child .card-img-bottom{border-bottom-right-radius:0}.card-group .card:last-child{border-bottom-left-radius:0;border-top-left-radius:0}.card-group .card:last-child .card-img-top{border-top-left-radius:0}.card-group .card:last-child .card-img-bottom{border-bottom-left-radius:0}.card-group .card:not(:first-child):not(:last-child){border-radius:0}.card-group .card:not(:first-child):not(:last-child) .card-img-bottom,.card-group .card:not(:first-child):not(:last-child) .card-img-top{border-radius:0}}@media (min-width:576px){.card-columns{-webkit-column-count:3;-moz-column-count:3;column-count:3;-webkit-column-gap:1.25rem;-moz-column-gap:1.25rem;column-gap:1.25rem}.card-columns .card{display:inline-block;width:100%;margin-bottom:.75rem}}.img-fluid{max-width:100%;height:auto}@media (min-width:576px){a.card{overflow: hidden;}img.card-img-top.img-fluid{transition: 1.0s ease;}.card-img-top.img-fluid:hover{transform: scale(1.05);}}@media (min-width:1024px){img.card-img-top.img-fluid{height: 420px;}}@media screen and (min-width: 900px) and (max-width: 1024px) {img.card-img-top.img-fluid{height: 360px;}}@media screen and (min-width: 768px) and (max-width: 900px) {img.card-img-top.img-fluid{height: 310px;}}@media (max-width:768px){.block-content .col-md-8{width: 50%;float: left;}img.card-img-top.img-fluid{height: 400px;}}.block-content .col-md-8{margin-bottom: 20px;}@media (max-width:576px){img.card-img-top.img-fluid{height:270px }}@media (max-width:420px){img.card-img-top.img-fluid{height:200px;object-fit: cover;object-position: left top; }}@media (min-width:420px){img.card-img-top.img-fluid{object-fit: cover;object-position: left top; }}
</style>


<?php if ($block->displayPosts()) {
    $_helper    = $this->helper('Magefan\Stories\Helper\Image');
    $om = \Magento\Framework\App\ObjectManager::getInstance();
    $storeManager = $om->get('Magento\Store\Model\StoreManagerInterface');
    ?>
    <?php $_postCollection = $block->getPostCollection(); ?>
    <?php if ($_postCollection->count()) { ?>
        <div class="block related">
            <div class="block-title title">
                <strong id="block-relatedposts-heading" role="heading" aria-level="2">
                    <?php echo __('Related Posts') ?>
                </strong>
            </div>
            <div class="block-content row" style="margin:0px auto;">
                <?php $clearfix = 1; ?>
                <?php foreach ($_postCollection as $item) { ?>
                    <div class="col-md-8" >
                        <a class="card" href="<?=$item->getPostUrl()?>">
                            <img class="card-img-top img-fluid" src="<?= $_helper->init($item->getImage())->resize(390)?>" alt="Card image cap" width="100%">
                            <!-- 05-06-2017 - udayp - show share icons in related posts -->
                            <?php
                            $folderName = 'stories';
                            $imgname = $item->getImage();
                            $path = $folderName . '/' . $imgname;
                            $storiesImgUrl = $storeManager->getStore()->getBaseUrl(\Magento\Framework\UrlInterface::URL_TYPE_MEDIA) . $path;
                            ?>
                            <div onclick="javascript:_paq.push(['trackEvent', 'BlogPostViewPage', 'shareInRelatedPostsFromBlogPostViewPage','<?=$item->getPostUrl()?>']);" id="share_me" title="Share" class="share_me" style="top: 13px; margin-right: 26px;padding: 6px; " ><span class="icon-facebook fa fa-share-alt" style="color: #472d5d;"></span>
                                <p id="sharers">
                                    <a class="em-social-icon em-facebook" style="color: #472d5d;" href="https://www.facebook.com/sharer/sharer.php?u=<?php echo $item->getPostUrl() ?>&t=Homelot Fine Products" onclick="javascript:_paq.push(['trackEvent', 'BlogPostViewPage', 'facebookShareInRelatedPostsFromBlogPostViewPage','<?=$item->getPostUrl()?>']);" target="_blank" title="Facebook"><button><span class="icon-facebook fa fa-facebook"></span></button></a>
                                    <a class="em-social-icon em-facebook" style="color: #472d5d;" href="https://pinterest.com/pin/create/button/?url=<?php echo $item->getPostUrl(); ?>&media=<?php echo $storiesImgUrl; ?>&description=<?php echo strip_tags($item->getShortDescription()); ?>" onclick="javascript:_paq.push(['trackEvent', 'BlogPostViewPage', 'pinterestShareInRelatedPostsFromBlogPostViewPage','<?=$item->getPostUrl()?>']);" target="_blank" title="Pinterest"><button><span class="icon-pinterest fa fa-pinterest-square"></span></button></a>
                                </p>
                            </div>
                        </a>
                    </div>
                    <?php if(($clearfix++%3)==0): ?>
                        <br>
                    <?php endif; ?>
                <?php } ?>
            </div>
        </div>
    <?php } ?>
<?php } ?>


